2021-12-22 16:15:09,403 - DEBUG - query_db - {'url': <RequestUrl.DB_QUERY_LIST: '/db/query/list'>, 'query_type': <QueryType.ErpMissing: 'ErpMissing'>, 'limit': 5, 'skip': 0}
2021-12-22 16:16:52,412 - DEBUG - read_file2df - finished read file erp_11月旺店通数据5.csv, shape: (428, 10)
2021-12-22 16:16:52,412 - DEBUG - read_file2df - added df into global dfs, len(dfs) == 1
2021-12-22 16:16:52,438 - DEBUG - parse_df - {'raw columns': ['订单编号', '原始单号', '出库单编号', '仓库', '店铺', '收货地区', '物流公司', '实际重量', '物流单号', '发货时间']}
2021-12-22 16:16:52,447 - DEBUG - parse_df - columns selected 
2021-12-22 16:16:52,448 - DEBUG - parse_df - rows_1_initial: 428
2021-12-22 16:16:52,476 - DEBUG - parse_df - rows_2_dropna_id: 428
2021-12-22 16:16:52,480 - DEBUG - parse_df - rows_3_drop_duplicated_id: 428
2021-12-22 16:16:52,486 - DEBUG - parse_df - rows_4_dropna: 428
2021-12-22 16:16:52,498 - DEBUG - parse_df - rows_5_drop_weight_invalid: 428
2021-12-22 16:16:52,507 - DEBUG - parse_df - rows_6_drop_date_invalid: 428
2021-12-22 16:16:52,509 - DEBUG - parse_df - rows_7_drop_province_invalid: 428
2021-12-22 16:28:40,304 - DEBUG - query_db - {'url': <RequestUrl.DB_QUERY_LIST: '/db/query/list'>, 'query_type': <QueryType.ErpMissing: 'ErpMissing'>, 'limit': 5, 'skip': 0}
2021-12-22 16:28:55,763 - DEBUG - query_db - {'url': <RequestUrl.DB_QUERY_LIST: '/db/query/list'>, 'query_type': <QueryType.ErpMissing: 'ErpMissing'>, 'limit': 5, 'skip': 0}
2021-12-22 16:29:15,234 - DEBUG - read_file2df - finished read file erp_11月旺店通数据.csv, shape: (147676, 10)
2021-12-22 16:29:15,235 - DEBUG - read_file2df - added df into global dfs, len(dfs) == 1
2021-12-22 16:29:15,251 - DEBUG - parse_df - {'raw columns': ['订单编号', '原始单号', '出库单编号', '仓库', '店铺', '收货地区', '物流公司', '实际重量', '物流单号', '发货时间']}
2021-12-22 16:29:15,261 - DEBUG - parse_df - columns selected 
2021-12-22 16:29:15,261 - DEBUG - parse_df - rows_1_initial: 147676
2021-12-22 16:29:15,287 - DEBUG - parse_df - rows_2_dropna_id: 147675
2021-12-22 16:29:15,329 - DEBUG - parse_df - rows_3_drop_duplicated_id: 147675
2021-12-22 16:29:15,744 - DEBUG - parse_df - rows_4_dropna: 147675
2021-12-22 16:29:15,759 - DEBUG - parse_df - rows_5_drop_weight_invalid: 147675
2021-12-22 16:29:16,247 - DEBUG - parse_df - rows_6_drop_date_invalid: 147675
2021-12-22 16:29:16,470 - DEBUG - parse_df - rows_7_drop_province_invalid: 147674
2021-12-22 16:30:59,572 - DEBUG - push_db - {'nUpserted': 0, 'nMatched': 147674, 'nModified': 147674}
2021-12-22 16:30:59,579 - DEBUG - push_db - saved synchronized into coll of stat
2021-12-22 16:31:55,591 - DEBUG - query_db - {'url': <RequestUrl.DB_QUERY_LIST: '/db/query/list'>, 'query_type': <QueryType.ErpMissing: 'ErpMissing'>, 'limit': 5, 'skip': 0}
2021-12-22 16:31:55,936 - DEBUG - query_db - {'url': <RequestUrl.DB_QUERY_LIST: '/db/query/list'>, 'query_type': <QueryType.ErpMissing: 'ErpMissing'>, 'limit': 5, 'skip': 0}
2021-12-22 16:32:16,709 - DEBUG - query_db - {'url': <RequestUrl.DB_QUERY_LIST: '/db/query/list'>, 'query_type': <QueryType.ErpMissing: 'ErpMissing'>, 'limit': 5, 'skip': 0}
2021-12-22 16:32:37,569 - DEBUG - query_db - {'url': <RequestUrl.DB_QUERY_LIST: '/db/query/list'>, 'query_type': <QueryType.ErpMissing: 'ErpMissing'>, 'limit': 5, 'skip': 0}
2021-12-22 16:32:37,827 - DEBUG - query_db - {'url': <RequestUrl.DB_QUERY_LIST: '/db/query/list'>, 'query_type': <QueryType.ErpMissing: 'ErpMissing'>, 'limit': 5, 'skip': 0}
2021-12-22 16:32:57,010 - DEBUG - query_db - {'url': <RequestUrl.DB_QUERY_LIST: '/db/query/list'>, 'query_type': <QueryType.ErpMissing: 'ErpMissing'>, 'limit': 5, 'skip': 0}
2021-12-22 16:33:04,500 - DEBUG - query_db - {'url': <RequestUrl.DB_QUERY_LIST: '/db/query/list'>, 'query_type': <QueryType.ErpMissing: 'ErpMissing'>, 'limit': 5, 'skip': 0}
2021-12-22 16:33:22,078 - DEBUG - read_file2df - finished read file erp_11月旺店通数据5.csv, shape: (428, 10)
2021-12-22 16:33:22,079 - DEBUG - read_file2df - added df into global dfs, len(dfs) == 1
2021-12-22 16:33:22,098 - DEBUG - parse_df - {'raw columns': ['订单编号', '原始单号', '出库单编号', '仓库', '店铺', '收货地区', '物流公司', '实际重量', '物流单号', '发货时间']}
2021-12-22 16:33:22,101 - DEBUG - parse_df - columns selected 
2021-12-22 16:33:22,101 - DEBUG - parse_df - rows_1_initial: 428
2021-12-22 16:33:22,106 - DEBUG - parse_df - rows_2_dropna_id: 428
2021-12-22 16:33:22,108 - DEBUG - parse_df - rows_3_drop_duplicated_id: 428
2021-12-22 16:33:22,132 - DEBUG - parse_df - rows_4_dropna: 428
2021-12-22 16:33:22,137 - DEBUG - parse_df - rows_5_drop_weight_invalid: 428
2021-12-22 16:33:22,141 - DEBUG - parse_df - rows_6_drop_date_invalid: 428
2021-12-22 16:33:22,143 - DEBUG - parse_df - rows_7_drop_province_invalid: 428
2021-12-22 16:33:25,752 - DEBUG - push_db - {'nUpserted': 0, 'nMatched': 428, 'nModified': 428}
2021-12-22 16:33:25,753 - DEBUG - push_db - saved synchronized into coll of stat
2021-12-22 18:01:12,399 - DEBUG - query_db - {'url': <RequestUrl.DB_QUERY_LIST: '/db/query/list'>, 'query_type': <QueryType.ErpMissing: 'ErpMissing'>, 'limit': 5, 'skip': 0}
2021-12-22 18:01:21,654 - DEBUG - read_file2df - {'sheet_names': ['_明细', '理赔', '价格表', '费用']}
2021-12-22 18:01:21,655 - DEBUG - read_file2df - {'found target sheet': '_明细'}
2021-12-22 18:01:24,067 - DEBUG - read_file2df - finished read file trd_2021-11_圆通.xlsx, shape: (15146, 17)
2021-12-22 18:01:24,067 - DEBUG - read_file2df - added df into global dfs, len(dfs) == 1
2021-12-22 18:01:24,086 - DEBUG - parse_df - {'raw columns': ['日期', '_快递', '运单号', '物料商家', '揽收重量', '取整', '取件业务员', '订单目的地网点名称', '订单目的地省份', '快递费', '重量', '取整.1', '差异', '城市', '核对城市', '金额', '差异金额']}
2021-12-22 18:01:24,086 - DEBUG - parse_df - columns_map: {'_快递': 'logistics', '运单号': '_id', '订单目的地省份': 'area', '揽收重量': 'weight', '快递费': 'fee', '日期': 'time'}
2021-12-22 18:01:24,097 - DEBUG - parse_df - columns selected 
2021-12-22 18:01:24,097 - DEBUG - parse_df - rows_1_initial: 15146
2021-12-22 18:01:24,104 - DEBUG - parse_df - rows_2_dropna_id: 15135
2021-12-22 18:01:24,112 - DEBUG - parse_df - rows_3_drop_duplicated_id: 15135
2021-12-22 18:01:24,163 - DEBUG - parse_df - rows_4_dropna: 15135
2021-12-22 18:01:24,171 - DEBUG - parse_df - rows_5_drop_weight_invalid: 15135
2021-12-22 18:01:24,251 - DEBUG - parse_df - rows_6_drop_date_invalid: 15135
2021-12-22 18:01:24,273 - DEBUG - parse_df - rows_7_drop_province_invalid: 15135
2021-12-22 18:01:24,276 - DEBUG - parse_df - rows_8_drop_fee_invalid: 15135
2021-12-22 18:01:56,551 - DEBUG - query_db - {'url': <RequestUrl.DB_QUERY_LIST: '/db/query/list'>, 'query_type': <QueryType.ErpMissing: 'ErpMissing'>, 'limit': 5, 'skip': 0}
2021-12-22 18:02:06,537 - DEBUG - read_file2df - {'sheet_names': ['_明细', '理赔', '价格表', '费用']}
2021-12-22 18:02:06,537 - DEBUG - read_file2df - {'found target sheet': '_明细'}
2021-12-22 18:02:08,700 - DEBUG - read_file2df - finished read file trd_2021-11_圆通.xlsx, shape: (15146, 17)
2021-12-22 18:02:08,700 - DEBUG - read_file2df - added df into global dfs, len(dfs) == 1
2021-12-22 18:02:08,719 - DEBUG - parse_df - {'raw columns': ['日期', '_快递', '运单号', '物料商家', '揽收重量', '取整', '取件业务员', '订单目的地网点名称', '订单目的地省份', '快递费', '重量', '取整.1', '差异', '城市', '核对城市', '金额', '差异金额']}
2021-12-22 18:02:08,720 - DEBUG - parse_df - columns_map: {'_快递': 'logistics', '运单号': '_id', '订单目的地省份': 'area', '揽收重量': 'weight', '快递费': 'fee', '日期': 'time'}
2021-12-22 18:02:08,721 - DEBUG - parse_df - columns selected 
2021-12-22 18:02:08,722 - DEBUG - parse_df - rows_1_initial: 15146
2021-12-22 18:02:08,726 - DEBUG - parse_df - rows_2_dropna_id: 15135
2021-12-22 18:02:08,733 - DEBUG - parse_df - rows_3_drop_duplicated_id: 15135
2021-12-22 18:02:08,810 - DEBUG - parse_df - rows_4_dropna: 15135
2021-12-22 18:02:08,813 - DEBUG - parse_df - rows_5_drop_weight_invalid: 15135
2021-12-22 18:02:08,897 - DEBUG - parse_df - rows_6_drop_date_invalid: 15135
2021-12-22 18:02:08,919 - DEBUG - parse_df - rows_7_drop_province_invalid: 15135
2021-12-22 18:02:08,922 - DEBUG - parse_df - rows_8_drop_fee_invalid: 15135
2021-12-22 18:02:41,531 - DEBUG - query_db - {'url': <RequestUrl.DB_QUERY_LIST: '/db/query/list'>, 'query_type': <QueryType.ErpMissing: 'ErpMissing'>, 'limit': 5, 'skip': 0}
2021-12-22 18:02:52,130 - DEBUG - query_db - {'url': <RequestUrl.DB_QUERY_LIST: '/db/query/list'>, 'query_type': <QueryType.ErpMissing: 'ErpMissing'>, 'limit': 5, 'skip': 0}
2021-12-22 18:30:10,016 - DEBUG - read_file2df - {'sheet_names': ['_明细', '理赔', '价格表', '费用']}
2021-12-22 18:30:10,017 - DEBUG - read_file2df - {'found target sheet': '_明细'}
2021-12-22 18:30:12,301 - DEBUG - read_file2df - finished read file trd_2021-11_圆通.xlsx, shape: (15146, 17)
2021-12-22 18:30:12,301 - DEBUG - read_file2df - added df into global dfs, len(dfs) == 1
2021-12-22 18:30:12,318 - DEBUG - parse_df - {'raw columns': ['日期', '_快递', '运单号', '物料商家', '揽收重量', '取整', '取件业务员', '订单目的地网点名称', '订单目的地省份', '快递费', '重量', '取整.1', '差异', '城市', '核对城市', '金额', '差异金额']}
2021-12-22 18:30:12,318 - DEBUG - parse_df - columns_map: {'_快递': 'logistics', '运单号': '_id', '订单目的地省份': 'area', '揽收重量': 'weight', '快递费': 'fee', '日期': 'time'}
2021-12-22 18:30:12,322 - DEBUG - parse_df - columns selected 
2021-12-22 18:30:12,322 - DEBUG - parse_df - rows_1_initial: 15146
2021-12-22 18:30:12,329 - DEBUG - parse_df - rows_2_dropna_id: 15135
2021-12-22 18:30:12,336 - DEBUG - parse_df - rows_3_drop_duplicated_id: 15135
2021-12-22 18:30:12,395 - DEBUG - parse_df - rows_4_dropna: 15135
2021-12-22 18:30:12,401 - DEBUG - parse_df - rows_5_drop_weight_invalid: 15135
2021-12-22 18:30:12,510 - DEBUG - parse_df - rows_6_drop_date_invalid: 15135
2021-12-22 18:30:12,545 - DEBUG - parse_df - rows_7_drop_province_invalid: 15135
2021-12-22 18:30:12,555 - DEBUG - parse_df - rows_8_drop_fee_invalid: 15135
2021-12-22 18:35:13,945 - DEBUG - query_db - {'url': <RequestUrl.DB_QUERY_LIST: '/db/query/list'>, 'query_type': <QueryType.ErpMissing: 'ErpMissing'>, 'limit': 5, 'skip': 0}
